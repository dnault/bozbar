<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">

    <script type="text/javascript"
            src="https://cdn.jsdelivr.net/jquery/1.5.1/jquery.min.js"></script>

    <!--<script type="text/javascript"
            src="https://code.jquery.com/jquery-2.1.4.min.js"></script>-->

    <script type="text/javascript"
            src="therapi/datagraph/jquery-jsonrpc/0.1.1/jquery.jsonrpc.js"></script>

    <!--
        <script type="text/javascript"
                src="script/jakearchibald/es6-promise-3.0.2/es6-promise.min.js"></script>
    -->

    <script type="text/javascript"
            src="jsonrpc/client.js"></script>


    <script type="text/javascript">
        $.jsonRPC.setup({
            endPoint: 'jsonrpc',
            //namespace: 'calculator'
        });

    </script>
</head>
<body>

<h1>Hi!</h1>
Welcome to the Therapi JSON-RPC example webapp. The JSON-RPC endpoint is <a href="jsonrpc">here</a>.
<p>
    If this is your first visit, start by browsing the <a href="jsonrpc/apidoc">automatically generated
    documentation</a>
    for the example services. The text you see on that page comes from Javadoc in the source code.
    The Javadoc was baked into the code using the <a href="https://github.com/dnault/therapi-runtime-javadoc">
    Therapi Runtime Javadoc</a> plugin for Gradle.

<p>
    From the documentation you can press the "Try It!" buttons to invoke the service methods.
    This feature is still experimental; the generated form might not be absolutely perfect
    for all kinds of method signatures, but it should give you an idea of how to invoke the methods
    from a real Javascript client.

<p>

<h2> Speaking of Javascript clients...</h2>
There's also an automatically generated Javascript client library
to play with. It uses the <a href="https://github.com/datagraph/jquery-jsonrpc">JSON RPC 2.0 jQuery Plugin</a>
in combination with <a href="jsonrpc/client.js">Javascript dynamically generated by the server</a>.

<p>
    The Javascript client is embedded in this welcome page, so you can experiment from here if you like.
    Open the Javascript console and try this:

<pre>
    // Print dictionary entries starting with "a"
    Therapi.dictionary.list("a").then(logit).catch(logit);
</pre>

Or chain <a href="https://blog.domenic.me/youre-missing-the-point-of-promises/">Promises</a> together, like so:

<pre>
    Therapi.dictionary.list()
        .then(function(words) {
            var randomWord = words[Math.floor(Math.random()*words.length)];
            console.debug(randomWord);
            return Therapi.dictionary.lookUp(randomWord);
        })
        .then(logit)
        .catch(logit);
</pre>


You don't have to use the auto-generated client; since JSON-RPC is a standard protocol,
you're free to use any client library you like.


<h2>Manual requests in a hurry</h2>

<p>
    Therapi also supports a non-standard request format that makes it easy to manually invoke methods
    from your browser's location bar. Here are some example links. After clicking them, check out your browser's
    location bar to see what the request URLs look like:

<ul>
    <li><a href="jsonrpc?r=dictionary.list">Manually invoking a method with zero arguments</a></li>
    <li><a href="jsonrpc?r=dictionary.list['a']">Manually invoking a method with positional arguments</a></li>
    <li><a href="jsonrpc?r=dictionary.list{prefix:'a'}">Manually invoking a method with named arguments</a></li>
</ul>

<h1>Diving deeper</h1>
When you're ready, take a look at the source code for the example services.
To use Therapi JSON-RPC in your own traditional webapp, you'll need to create a subclass of
<code>AbstractJsonRpcServlet</code> and register your services. Use the <code>ExampleJsonRpcServlet</code>
class as a template. Don't forget to add your new servlet to <code>web.xml</code> (see this webapp's
<code>web.xml</code> file for an example).
<p>
    If you'd rather use Spring Boot, or if you want to wire Therapi into a Spring MVC
    application, check out the project in the <code>spring-boot-example</code> folder.

<p>
    Some important things to remember:
<ol>
    <li>Your service interfaces must be compiled with the <code>-parameters</code> option to <code>javac</code>
        so that parameter names are available at runtime.
    </li>
    <li>If you want your Javadoc comments to be included in the API documentation, apply the Runtime Javadoc
        plugin to your Gradle project.
    </li>
</ol>
The example build script <code>build.gradle</code> takes care of both of these items.
Feel free to use it as a template.

<p>
    Found a bug? Have a feature request? <a href="https://github.com/dnault/therapi-json-rpc/issues">Let me know</a>.

<p>
    Okay, that's it. Have fun with Therapi, and welcome to the RESTless revolution!
    <br><br><br>
</body>
</html>



